<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, initial-scale=1.0, width=device-width" />
    <meta name="format-detection" content="telephone=no, email=no, date=no, address=no">
    <title>主页</title>
</head>

<body>
</body>
<script src="./script/api.js"></script>
<script src="./script/frameGroup.js"></script>
<script>
    apiready = function() {
        // api.addEventListener({
        //     name: 'keyback'
        // }, appExitEvent);

        api.addEventListener({
            name: 'addElectricExitEvent'
        }, function() {
            console.log('listen==addElectricExitEvent')
            electricExit = true;
        });

        api.addEventListener({
            name: 'removeElectricExitEvent'
        }, function() {
            electricExit = false;
        });

        // 打开主页面
        openMainFrameGroup();


        //检查新版本

        /*var isUpdate = api.require('man');

        isUpdate.checkUpdate(function (ret,err) {
            if(ret){
                var result = ret.result;

                if(result.update === true && result.closed === false){
                    var str = '新版本型号:' + result.version + '更新了XXXXXXX:' + result.updateTip + ';下载地址:' + result.source + ';发布时间:' + result.time;

                    api.confirm({
                        title:"APP新版本发布啦，请下载安装！",
                        msg:str,
                        buttons:['安装','打死也不']
                    },function (ret,err) {
                        //安装
                        if(ret.buttonindex == 1){
                            //安卓手机
                            if(api.systemType == 'android'){
                                api.download({
                                    url:result.source,
                                    report:true
                                },function (ret,err) {
                                    //显示下载进度

                                    if(ret && 0 === ret.state){
                                        api.showProgress({
                                            style: 'default',
                                            animationType: 'zoom',
                                            title: 'loading',
                                            text: '正在下载最新版本'+ret.percent + "%",
                                            modal: true
                                        });
                                    }
                                    //下载完成
                                    if(ret && 1 == ret.state){
                                        //提示安装（安卓）
                                        var ApkPath = ret.savePath;
                                        api.toast({
                                            msg : "下载完成，安装包已经保存在：" + ApkPath + "目录下",
                                            duration : 2000
                                        });

                                        api.confirm({
                                            title:'提示',
                                            msg:'下载完成，是否立即安装？',
                                            buttons:['安装','取消']
                                        },function (ret,err) {
                                            if(ret.buttonindex == 1){
                                                //开始安装
                                                api.installApp({
                                                    appUrl:ApkPath,
                                                })
                                            }else{

                                            }
                                        })
                                    }
                                })
                            }
                        }
                    })
                }else{
                    //没有更新
                }
            }
        })*/
    }
</script>

</html>
